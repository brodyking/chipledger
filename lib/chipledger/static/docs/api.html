<script>
    document.title = "API - Chipledger Docs";
</script>
<main id="main">
    <h2 class="mt-5" id="about-this-project">API</h2>
    <p>
        The API on Chipledger is the communication between the database and the frontend (and server rendered
        components). It is written in PHP, usually
        takes in GET parameters, and sends back JSON.
    </p>
    <h4 id="table-of-contents">
        Table of Contents
    </h4>
    <p>
    <ol>
        <li>
            <a href="#cheat-sheet">Cheat Sheet</a>
        </li>
        <li>
            <a href="#authentication">Authentication</a>
        </li>
        <li>
            <a href="#data">Data (Content)</a>
        </li>
        <li>
            <a href="#game">Game</a>
        </li>
        <li>
            <a href="#user">User</a>
        </li>
    </ol>
    </p>
    <h4 id="cheat-sheet">
        Cheat Sheet
    </h4>
    <p>
        Here are all of the API endpoints that are available, in one master table.
    </p>
    <div class="table-responsive">
        <table class="table border table-striped">
            <thead>
                <td>Endpoint</td>
                <td>Definition</td>
            </thead>
            <tbody>
                <tr>
                    <td>/api/auth/register</td>
                    <td>Registration api, creates new accounts, generates session ids.</td>
                </tr>
                <tr>
                    <td>/api/auth/login</td>
                    <td>Login api, generates session ids.</td>
                </tr>
                <tr>
                    <td>/api/auth/logout</td>
                    <td>Clears session ids.</td>
                </tr>
                <tr>
                    <td>/api/data/releaseNotes</td>
                    <td>Returns HTML inside of JSON with all the Release Notes.</td>
                </tr>
                <tr>
                    <td>/api/data/tutorial</td>
                    <td>Returns HTML inside of JSON with the tutorial page.</td>
                </tr>
                <tr>
                    <td>/api/game/new</td>
                    <td>Creation of new games</td>
                </tr>
                <tr>
                    <td>/api/game/delete</td>
                    <td>Deletion of games</td>
                </tr>
                <tr>
                    <td>/api/game/list</td>
                    <td>Sends a JSON list of all available games</td>
                </tr>
                <tr>
                    <td>/api/game/rename</td>
                    <td>Renames a game.</td>
                </tr>
                <tr>
                    <td>/api/game/addPlayer</td>
                    <td>Adds a player to a game</td>
                </tr>
                <tr>
                    <td>/api/game/addBuyin</td>
                    <td>Adds a buyin to a player in a game</td>
                </tr>
                <tr>
                    <td>/api/game/addCashout</td>
                    <td>Adds a cashout to a player in a game</td>
                </tr>
                <tr>
                    <td>/api/game/get</td>
                    <td>Gets all the current details of a game.</td>
                </tr>
                <tr>
                    <td>/api/user/changePassword</td>
                    <td>Changes the users password.</td>
                </tr>
                <tr>
                    <td>/api/user/changeEmail</td>
                    <td>Changes the users email.</td>
                </tr>
                <tr>
                    <td>/api/user/delete</td>
                    <td>Deletes a users account.</td>
                </tr>
                <tr>
                    <td>/api/user/get</td>
                    <td>Returns information on the users account.</td>
                </tr>
            </tbody>
        </table>
    </div>
    <h4 id="authentication">
        Authentication
    </h4>
    <p>
        Authentication endpoints include login, registration, and logouts.
    </p>
    <div class="table-responsive">
        <table class="table table-striped border">
            <thead>
                <td>Name</td>
                <td>URL</td>
                <td>GET</td>
                <td>POST</td>
                <td>COOKIE</td>
                <td>Return Type</td>
                <td>Return Contents</td>
            </thead>
            <tr>
                <td>Login</td>
                <td>/api/auth/login</td>
                <td><code>username</code>, <code>password</code></td>
                <td><i class="bi bi-x"></i></td>
                <td><i class="bi bi-x"></i></td>
                <td>JSON</td>
                <td><code>username</code>, <code>session</code> or <code>error</code></td>
            </tr>
            <tr>
                <td>Register</td>
                <td>/api/auth/register</td>
                <td><code>username</code>, <code>email</code>, <code>password</code></td>
                <td><i class="bi bi-x"></i></td>
                <td><i class="bi bi-x"></i></td>
                <td>JSON</td>
                <td><code>username</code>, <code>session</code> or <code>error</code></td>
            </tr>
            <tr>
                <td>Logout</td>
                <td>/api/auth/logout</td>
                <td><i class="bi bi-x"></i></td>
                <td><i class="bi bi-x"></i></td>
                <td><code>username</code>, <code>session</code></td>
                <td><i class="bi bi-x"></i></td>
                <td><i class="bi bi-x"></i></td>
            </tr>
        </table>
    </div>
    <p>
        Login and Register assign new session ids, and sets them inside of the database and the users cookies.
    </p>
    <p>
        Logout is not to be used inside of the JS.
        It is rather used as a link to send when users logout.
        It headers the user to the homepage when completed.
        This is because not logged in users and authenticated users required different js scripts.
    </p>
    <h4 id="data">
       Data (Content)
    </h4>
    <p>
        These return content to fill pages. Donation has been removed. 
    </p>
    <div class="table-responsive">
        <table class="table table-striped border">
            <thead>
                <td>Name</td>
                <td>URL</td>
                <td>GET</td>
                <td>POST</td>
                <td>COOKIE</td>
                <td>Return Type</td>
                <td>Return Contents</td>
            </thead>
            <tr>
                <td>Release Notes</td>
                <td>/api/data/releaseNotes</td>
                <td><i class="bi bi-x"></i></td>
                <td><i class="bi bi-x"></i></td>
                <td><i class="bi bi-x"></i></td>
                <td>JSON</td>
                <td><code>data</code></td>
            </tr>
            <tr>
                <td>Tutorial</td>
                <td>/api/data/tutorial</td>
                <td><i class="bi bi-x"></i></td>
                <td><i class="bi bi-x"></i></td>
                <td><i class="bi bi-x"></i></td>
                <td>JSON</td>
                <td><code>data</code></td>
            </tr>
        </table>
    </div>
    <p>
        All of these endpoints return a data object which is a string full of HTML, and require no information or auth.
    </p>
    <h4 id="game">
        Game
    </h4>
    <p>
        All things related to current games for each user.
    </p>
    <div class="table-responsive">
        <table class="table table-striped border">
            <thead>
                <td>Name</td>
                <td>URL</td>
                <td>GET</td>
                <td>POST</td>
                <td>COOKIE</td>
                <td>Return Type</td>
                <td>Return Contents</td>
            </thead>
            <tr>
                <td>New</td>
                <td>/api/game/new</td>
                <td><code>name</code></td>
                <td><i class="bi bi-x"></i></td>
                <td><code>username</code>, <code>session</code></td>
                <td>JSON</td>
                <td><code>data</code> or <code>error</code></td>
            </tr>
            <tr>
                <td>Delete</td>
                <td>/api/game/delete</td>
                <td><code>name</code></td>
                <td><i class="bi bi-x"></i></td>
                <td><code>username</code>, <code>session</code></td>
                <td>JSON</td>
                <td><code>success</code> or <code>error</code></td>
            </tr>
            <tr>
                <td>List</td>
                <td>/api/game/list</td>
                <td><i class="bi bi-x"></i></td>
                <td><i class="bi bi-x"></i></td>
                <td><code>username</code>, <code>session</code></td>
                <td>JSON</td>
                <td>Returns a list of all available games. Each item is the game name.</td>
            </tr>
            <tr>
                <td>Rename</td>
                <td>/api/game/rename</td>
                <td><code>oldname</code>, <code>newname</code></td>
                <td><i class="bi bi-x"></i></td>
                <td><code>username</code>, <code>session</code></td>
                <td>JSON</td>
                <td><code>name</code> or <code>error</code></td>
            </tr>
            <tr>
                <td>Add Player</td>
                <td>/api/game/addPlayer</td>
                <td><code>name</code>, <code>playername</code></td>
                <td><i class="bi bi-x"></i></td>
                <td><code>username</code>, <code>session</code></td>
                <td>JSON</td>
                <td><code>data</code> or <code>error</code></td>
            </tr>
            <tr>
                <td>Add Buyin</td>
                <td>/api/game/addBuyin</td>
                <td><code>name</code>, <code>playername</code>, <code>amount</code>, <code>method</code></td>
                <td><i class="bi bi-x"></i></td>
                <td><code>username</code>, <code>session</code></td>
                <td>JSON</td>
                <td><code>data</code> or <code>error</code></td>
            </tr>
            <tr>
                <td>Add Cashout</td>
                <td>/api/game/addCashout</td>
                <td><code>name</code>, <code>playername</code>, <code>amount</code>, <code>method</code></td>
                <td><i class="bi bi-x"></i></td>
                <td><code>username</code>, <code>session</code></td>
                <td>JSON</td>
                <td><code>data</code> or <code>error</code></td>
            </tr>
            <tr>
                <td>Edit Buyin</td>
                <td>/api/game/editBuyin</td>
                <td><code>name</code>, <code>playername</code>, <code>amount</code>, <code>method</code>, <code>buyinId</code></td>
                <td><i class="bi bi-x"></i></td>
                <td><code>username</code>, <code>session</code></td>
                <td>JSON</td>
                <td><code>data</code> or <code>error</code></td>
            </tr>
            <tr>
                <td>Edit Cashout</td>
                <td>/api/game/editCashout</td>
                <td><code>name</code>, <code>playername</code>, <code>amount</code>, <code>method</code>, <code>cashoutId</code></td>
                <td><i class="bi bi-x"></i></td>
                <td><code>username</code>, <code>session</code></td>
                <td>JSON</td>
                <td><code>data</code> or <code>error</code></td>
            </tr>
            <tr>
                <td>Get</td>
                <td>/api/game/get</td>
                <td><code>name</code></td>
                <td><i class="bi bi-x"></i></td>
                <td><code>username</code>, <code>session</code></td>
                <td>JSON</td>
                <td><code>data</code> or <code>error</code></td>
            </tr>
        </table>
    </div>
    <p>
        The list endpoint returns a json list of all available games. It would look like this:
    </p>
    <pre class="rounded border bg-body-tertiary p-3"><code>["gameName1","gameName2"]</code></pre>
    <p>
        Almost all of these endpoints return an updated version of the game.
        When a user acts upon an action, the JS sends a request at the endpoint, and if it recieves data, updates the
        dom.
    </p>
    <p>
        The data endpoint is only used in rare circumstances, but returns what any action would without any
        modifications to the database.
    </p>
    <p>
        Like other endpoints, the API call only succeeds if the cookies for the session and username are <b>set and
            valid</b>.
    </p>
    <h4 id="user">
        User
    </h4>
    <p>
        Slightly different than auth. Mostly relates to user settings and such.
    </p>
    <div class="table-responsive">
        <table class="table table-striped border">
            <thead>
                <td>Name</td>
                <td>URL</td>
                <td>GET</td>
                <td>POST</td>
                <td>COOKIE</td>
                <td>Return Type</td>
                <td>Return Contents</td>
            </thead>
            <tr>
                <td>Change Password</td>
                <td>/api/user/changePassword</td>
                <td><code>newpassword</code></td>
                <td><i class="bi bi-x"></i></td>
                <td><code>username</code>, <code>session</code></td>
                <td>JSON</td>
                <td><code>success</code> or <code>error</code></td>
            </tr>
            <tr>
                <td>Change Email</td>
                <td>/api/user/changeEmail</td>
                <td><code>newemail</code></td>
                <td><i class="bi bi-x"></i></td>
                <td><code>username</code>, <code>session</code></td>
                <td>JSON</td>
                <td><code>success</code> or <code>error</code></td>
            </tr>
            <tr>
                <td>Delete</td>
                <td>/api/user/delete</td>
                <td><code>name</code></td>
                <td><i class="bi bi-x"></i></td>
                <td><code>username</code>, <code>session</code></td>
                <td>JSON</td>
                <td><code>success</code> or <code>error</code></td>
            </tr>
            <tr>
                <td>Get</td>
                <td>/api/user/get</td>
                <td><code>name</code></td>
                <td><i class="bi bi-x"></i></td>
                <td><code>username</code>, <code>session</code></td>
                <td>JSON</td>
                <td>A list of details about the users account or <code>error</code></td>
            </tr>
        </table>
    </div>
    <p>
        All of these are ran in browser, and no redirects should happen.
    </p>
    <p>
        Delete will redirect the user through javascript, even though it may appear to be server side.
    </p>
</main>